// show dbs
// use dbName
// db


//db.collection.find()

// db.movies.insertMany(
//     [
//         {
//           "name": "Dada",
//           "rating": 8.5,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/23mMdgo0prk",
//           "language":"tamil"
//         },
      
//         {
//           "name": "remo",
//           "rating": 8.7,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/GEB4qrrWIgs",
//           "language":"tamil"
//         },
      
//         {
//           "name": "super deluxe",
//           "rating": 7.5,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/3-Xq_Zz3nPA",
//           "language":"english"
//         },
      
//         {
//           "name": "good night",
//           "rating": 7.9,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/eLPePlnFoho",
//           "language":"english"
//         },
      
//         {
//           "name": "fight club",
//           "rating": 7.5,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/oQVhwMYRgFY",
//           "language":"french"
//         },
      
//         {
//           "name": "mankatha",
//           "rating": 9,
//           "summary": "Dada is an emotional drama about a young man dealing with becoming a parent, out of the blue, with a lot of maturity",
//           "poster": "https://th.bing.com/th?id=OIP.7l1bfGe-kAEZE_VaTGVEeAHaLH&w=204&h=306&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2",
//           "trailer": "https://www.youtube.com/embed/vHESM8iR1JE",
//           "language":"french"
//         }
//       ]
      
// )


db.movies.insertMany(
  [
    {
      "name": "Vikram",
      "poster": "https://th.bing.com/th/id/OIP.A0Eib43MII1xcHMaiUShQgHaLQ?w=195&h=297&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 8.1,
      "summary": "Chief of police Jose summons Amar and his black-ops team to bring justice to a group of masked vigilantes who killed Stephen Raj, who was recently released following his arrest three months earlier for helping gangsters Adaikalam and Anbu",
      "trailer": "https://www.youtube.com/embed/OKBMCL-frPU"
    },
  
    {
      "name": "THEERAN",
      "poster": "https://th.bing.com/th/id/OIP.QEy14kvM_lsyECi-eCt1CgHaKG?w=195&h=265&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 8.7,
      "summary": "Sasi, who is the cop in charge, orders that the documented criminal cases in the form of manuscripts be converted into digital format. During this process, he comes across a really spine-chilling dacoity murder case from several years ago",
      "trailer": "https://www.youtube.com/embed/uLuGOOFORAs"
    },
  
    {
      "name": "KAITHI",
      "poster": "https://th.bing.com/th/id/OIP.F3kuhIUUHuWRu4MoFsQM8QHaKL?w=195&h=268&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 8.5,
      "summary": "The caretakers at an orphanage inform a young girl named Amudha that an important person will meet her the next day, and she waits anxiously. Meanwhile, Inspector Bejoy and his team catch a van smuggling 900 kilos of cocaine.",
      "trailer": "https://www.youtube.com/embed/g79CvhHaj5I"
    },
  
    {
      "name": "LEO",
      "poster": "https://th.bing.com/th/id/OIP.4LghctcGIXbP1oIyYijbAgHaJQ?w=115&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 7.3,
      "summary": "One night, Parthi and Chintu are at the cafÃ© when Shanmugham, a robber, and his men arrive to rob it. Parthi tries to appease them by giving them money, but one of the gang members makes a move on his employee Shruthi.",
      "trailer": "https://www.youtube.com/embed/Po3jStA673E"
    },
  
    {
      "name": "VIKRAM VEDHA",
      "poster": "https://th.bing.com/th/id/OIP._ZLPbh1hU_W6oG_7T-FM_AHaHa?w=147&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 8.2,
      "summary": "Vikram is an honest police inspector who has a black-and-white sense of good and evil. Vedha is a dreaded gangster who understands the nuance in between. Vikram's best friend Simon leads an encounter unit formed to eliminate Vedha.",
      "trailer": "https://www.youtube.com/embed/1sVr-uWZPjE"
    },
  
    {
      "name": "SATHURANGA VETTAI",
      "poster": "https://th.bing.com/th/id/OIP.n2MiIY1lKMiVFw8N9R7rPAHaLH?w=124&h=186&c=7&r=0&o=5&dpr=1.5&pid=1.7",
      "rating": 8.5,
      "summary": "Gandhi Babu is a skilled con artist, who dreams of doing ingenious scams and executes them perfectly. His scams include selling ignorant people ordinary snakes, claiming that they are exotic and will fetch crores in the international market, promoting a nonexistent multilevel marketing company with its controversial chain referral schemes promising a BMW car within a year.",
      "trailer": "https://www.youtube.com/embed/HQeRWsVmPtk"
    }
  ]
  
)
db.movies.find({})

db.movies.find({}).pretty();

db.movies.find({rating:{$gt:8}}).pretty();

db.movies.find({rating:{$gte:8}}).pretty();

db.movies.find({rating:{$lt:8}}).pretty();

db.movies.find({rating:{$lte:8}}).pretty();

//projection

//inclusion -1

db.movies.find({},{name:1,rating:1}).pretty();

//eclusion-0

db.movies.find({},{name:0,rating:0}).pretty();


//sorting
//asc-1-rating-asc
db.movies.find({}).sort({rating:1}).pretty();

//desc- -1
db.movies.find({}).sort({rating:-1}).pretty();


//first two books with highest rating
db.movies.find({}).sort({rating:-1}).limit(2).pretty();

//skip first 2

db.movies.find({}).sort({rating:-1}).skip(2).pretty();

//combine include+exclude

db.movies.find({},{_id: 0,name:1,rating:1}).pretty();

db.movies.find({},{_id: 1,name:1,rating:1}).pretty();

db.movies.find({},{_id: 0,name:1,rating:1,summary:1}).pretty();


//combine-operator+projection+sorting

db.movies.find({rating:{$gt:8}},{_id: 0,name:1,rating:1,summary:1}).sort({rating:1}).pretty();

//sort+projection - id-exclude,name,rating-include,sort -des,limit -2

db.movies.find({},{_id:0,name:1,rating:1}).sort({rating:-1}).limit(2).pretty();


//sort by rating in desc and include summary and trailer,skip(-2)

db.movies.find({},{summary:1,trailer:1}).sort({rating:-1}).skip(2).pretty();

//find only one document with rating

db.movies.findOne({rating:8.8})

db.movies.find({rating:8.8}).pretty();

//aggregation
//select sum(quantity) from orders where status = "urgent"
//group by product name

db.orders.insertMany([
  {_id:0,productName:"steel beam",status:"new",quantity:10},
  {_id:1,productName:"steel beam",status:"urgent",quantity:20},
  {_id:2,productName:"steel beam",status:"urgent",quantity:30},
  {_id:3,productName:"Iron Rod",status:"new",quantity:15},
  {_id:4,productName:"Iron Rod",status:"urgent",quantity:50},
  {_id:5,productName:"Iron Rod",status:"new",quantity:10},
])

db.orders.find({}).pretty()

//stage1 
//status -urgent

db.orders.aggregate([{$match:{status:"urgent"}}])

//stage 2
//$match,$group,$sum - aggregate methods,operators

db.orders.aggregate([{$match:{status:"urgent"}},{$group:{_id:"$productName",totalUrgentQuantity:{$sum:"$quantity"}}}])


db.movies.updateMany({},{$set:{language:"English"}});


db.movies.updateOne({name:"Dada"},{$set:{language:"French"}})
db.movies.updateOne({name:"Dada"},{$set:{rating:9}})

//delete all movies with rating>8

db.movies.find({rating:{$gt:8}},{name:1,rating:1}).pretty()

db.movies.deleteOne({rating:{$gt:8}})

db.movies.deleteMany({rating:{$gt:8}})
